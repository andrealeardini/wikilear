{% extends "layouts/base.njk" %}
{% set pageHeaderTitle = title %}
{# Grab other posts that arenâ€™t this one for the 'more from the blog' feed #}
{% set recommendedPosts = helpers.getSiblingContent(collections.blog, page) %}
{# Render post date#}
{% set pageHeaderSummary %}
<div>
  <time class="text-sm md:text-base" datetime="{{ date | w3DateFilter }}">{{ date | dateFilter }}</time>
</div>
{% if subtitle %}
  <p class="italic my-4">{{ subtitle | safe }}</p>
{% endif %}
{% endset %}

{% block content %}
  {% if image %}
    <img
      src="{{ image }}"
      {% if image-description %}
      alt="{{ image-description }}"
      {% else %}
      alt=""
      {% endif %}
      {% if image_title %}
      title="{{ image_title }}"
      {% endif %}
      class="my-4 rounded-lg w-full"
    />
  {% endif %}
  {% include "partials/page-header.njk" %}
  <div class="{{ style }}">
    {{ content | safe }}
  </div>

   {% if tags %}
    <p class="mt-8 font-semibold" id="tags-desc">
      Etichette
    </p>
    <div class="mb-6" aria-describedby="tags-desc">
      {% include "components/tags-post.njk" %}
    </div>
  {% endif %}

  {% include "components/share.njk" %}

  <hr class="mt-4 mb-4">
  <p class="text-sm">Hai trovato un errore o vuoi contribuire a questo articolo? <a href="https://github.com/andrealeardini/wikilear/edit/main/src{{ page.filePathStem }}.md" rel="noopener noreferrer">Modifica questa pagina su GitHub!</a>
  </p>

  {% block posts %}
    {# https://github.com/11ty/eleventy/issues/434#issuecomment-469028924 #}
    {% import "components/nav-posts.njk" as nav with context %}
    {{ nav.posts(collections[collection]) }}
  {% endblock %}

  {% if recommendedPosts %}
    <footer class="recommended-posts">
      {% set postListItems = recommendedPosts %}
      {% set postListHeadline = 'Altri articoli dal blog' %}
      {% include "partials/post-list.njk" %}
    </footer>
  {% endif %}

  {# https://github.com/google/eleventy-high-performance-blog/blob/60902bfdaf764f5b16b2af62cf10f63e0e74efbc/_includes/layouts/post.njk#L34 #}
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ title }}",
  "image": {% if image %}"{{ site.url }}{{ image }}"{% else %}[]{% endif %},
  "author": "{{ site.author.name }}",
  "genre": "{{ site.genre }}",
  "publisher": {
    "@type": "Organization",
    "name": "{{ site.publisher.name }}",
  },
  "url": "{{ site.url }}{{ canonicalUrl or page.url }}",
  "mainEntityOfPage": "{{ site.url }}{{ canonicalUrl or page.url }}",
  "datePublished": "{{ page.date | htmlDateString }}",
  "dateModified": "{{ page.inputPath | lastModifiedDate  | htmlDateString }}",
  "description": "{{ subtitle | striptags }}"
}
</script>

image: {{ image }}

{% endblock %}